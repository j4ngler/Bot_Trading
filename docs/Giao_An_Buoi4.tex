% -*- coding: utf-8 -*-
\documentclass[12pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[vietnamese]{babel}
\usepackage{amsmath,amssymb}
\usepackage{geometry}
\usepackage{fancyhdr}
\usepackage{booktabs}
\usepackage{graphicx}
\usepackage{xcolor}
\usepackage{enumitem}

\geometry{margin=2.3cm}
\pagestyle{fancy}
\fancyhf{}
\fancyhead[L]{Bu·ªïi 4 - Qu·∫£n l√Ω r·ªßi ro \& V·ªã th·∫ø}
\fancyhead[R]{Trading Bot - Testnet}
\fancyfoot[C]{\thepage}

\title{\textbf{Gi√°o √Ån Bu·ªïi 4}\\
\large Qu·∫£n L√Ω R·ªßi Ro \& V·ªã Th·∫ø: C√¥ng Th·ª©c T√≠nh Kh·ªëi L∆∞·ª£ng, SL/TP, R/R}
\author{}
\date{}

\begin{document}

\maketitle

\section*{1. M·ª•c ti√™u bu·ªïi h·ªçc}
\begin{itemize}[leftmargin=1.2cm]
    \item Hi·ªÉu v√† v·∫≠n d·ª•ng quy t·∫Øc 1\% v·ªën: ch·ªâ r·ªßi ro t·ªëi ƒëa 1\% s·ªë d∆∞ m·ªói l·ªánh.
    \item N·∫Øm c√¥ng th·ª©c t√≠nh kh·ªëi l∆∞·ª£ng v·ªã th·∫ø d·ª±a tr√™n stop loss v√† r·ªßi ro ch·∫•p nh·∫≠n ƒë∆∞·ª£c.
    \item Hi·ªÉu c√°ch ƒë·∫∑t Stop Loss v√† Take Profit d·ª±a tr√™n ATR (linh ho·∫°t) ho·∫∑c ph·∫ßn trƒÉm c·ªë ƒë·ªãnh.
    \item T√≠nh ƒë∆∞·ª£c t·ª∑ l·ªá Risk/Reward (R/R) v√† ƒë√°nh gi√° xem l·ªánh c√≥ ƒë√°ng th·ª±c hi·ªán kh√¥ng (R/R $\geq$ 1.5).
    \item Th·ª±c h√†nh ƒë·ªçc code trong \texttt{risk\_manager.py} ƒë·ªÉ hi·ªÉu c√°ch bot t√≠nh to√°n v·ªã th·∫ø.
\end{itemize}

\section*{2. Chu·∫©n b·ªã}
\begin{itemize}[leftmargin=1.2cm]
    \item M√°y ƒë√£ c√†i ƒë·∫∑t m√¥i tr∆∞·ªùng, c√≥ th·ªÉ ch·∫°y GUI v√† xem log.
    \item File \texttt{src/risk\_manager.py} v√† \texttt{src/config.py} ƒë√£ m·ªü s·∫µn trong editor.
    \item M√°y t√≠nh c·∫ßm tay ho·∫∑c c√¥ng c·ª• t√≠nh to√°n ƒë·ªÉ th·ª±c h√†nh c√¥ng th·ª©c.
    \item B·∫£ng v√≠ d·ª• s·ªë li·ªáu m·∫´u: V·ªën = \$10,000, Gi√° BTC = \$43,250, ATR = \$250, Risk = 1\%.
\end{itemize}

\section*{3. L·ªô tr√¨nh 90 ph√∫t}

\subsection*{A. Warm-up: ``N·∫øu b·∫°n c√≥ \$10,000, b·∫°n d√°m r·ªßi ro bao nhi√™u?'' (5')}
\textbf{Ho·∫°t ƒë·ªông:} GV ƒë·∫∑t c√¢u h·ªèi m·ªü:
\begin{itemize}[leftmargin=0.5cm]
    \item ``N·∫øu b·∫°n c√≥ \$10,000 v√† mu·ªën trade BTC, b·∫°n s·∫Ω mua bao nhi√™u?''
    \item ``N·∫øu gi√° BTC gi·∫£m 5\%, b·∫°n s·∫Ω m·∫•t bao nhi√™u?''
    \item ``B·∫°n c√≥ ch·∫•p nh·∫≠n m·∫•t \$500 (5\%) trong m·ªôt l·ªánh kh√¥ng?''
\end{itemize}
\textbf{K·∫øt lu·∫≠n:} H·∫ßu h·∫øt trader nghi·ªáp d∆∞ kh√¥ng c√≥ quy t·∫Øc r√µ r√†ng, d·∫´n ƒë·∫øn r·ªßi ro qu√° cao ho·∫∑c qu√° th·∫•p. Bot s·ª≠ d·ª•ng quy t·∫Øc 1\% ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n: ch·ªâ r·ªßi ro t·ªëi ƒëa \$100 tr√™n \$10,000 v·ªën m·ªói l·ªánh.

\subsection*{B. Quy t·∫Øc 1\% v·ªën (15')}

\textbf{B∆∞·ªõc 1: Gi·∫£i th√≠ch quy t·∫Øc (5')}
\begin{itemize}[leftmargin=0.5cm]
    \item \textbf{Quy t·∫Øc 1\%:} Ch·ªâ r·ªßi ro t·ªëi ƒëa 1\% s·ªë d∆∞ t√†i kho·∫£n m·ªói l·ªánh.
    \item V√≠ d·ª•: V·ªën = \$10,000 $\Rightarrow$ R·ªßi ro t·ªëi ƒëa = \$10,000 $\times$ 1\% = \$100
    \item \textbf{T·∫°i sao 1\%?}
    \begin{itemize}
        \item N·∫øu m·∫•t 10 l·ªánh li√™n ti·∫øp, b·∫°n ch·ªâ m·∫•t 10\% v·ªën (v·∫´n c√≤n 90\% ƒë·ªÉ ti·∫øp t·ª•c)
        \item N·∫øu r·ªßi ro 5\% m·ªói l·ªánh, ch·ªâ c·∫ßn 20 l·ªánh thua l√† m·∫•t h·∫øt v·ªën
        \item Quy t·∫Øc n√†y gi√∫p trader s·ªëng s√≥t qua c√°c chu·ªói l·ªánh thua
    \end{itemize}
\end{itemize}

\textbf{B∆∞·ªõc 2: Th·ª±c h√†nh t√≠nh to√°n (10')}
\begin{itemize}[leftmargin=0.5cm]
    \item \textbf{B√†i t·∫≠p 1:} V·ªën = \$10,000, Risk = 1\%. T√≠nh s·ªë ti·ªÅn r·ªßi ro t·ªëi ƒëa?
    \begin{itemize}
        \item ƒê√°p √°n: \$10,000 $\times$ 0.01 = \$100
    \end{itemize}
    \item \textbf{B√†i t·∫≠p 2:} V·ªën = \$5,000, Risk = 1.5\%. T√≠nh s·ªë ti·ªÅn r·ªßi ro?
    \begin{itemize}
        \item ƒê√°p √°n: \$5,000 $\times$ 0.015 = \$75
    \end{itemize}
    \item \textbf{B√†i t·∫≠p 3:} N·∫øu b·∫°n c√≥ \$20,000 v√† mu·ªën r·ªßi ro 2\% m·ªói l·ªánh, b·∫°n s·∫Ω m·∫•t bao nhi√™u n·∫øu thua 5 l·ªánh li√™n ti·∫øp?
    \begin{itemize}
        \item ƒê√°p √°n: \$20,000 $\times$ 0.02 $\times$ 5 = \$2,000 (m·∫•t 10\% v·ªën)
    \end{itemize}
\end{itemize}

\textit{Li√™n h·ªá kinh t·∫ø:} Quy t·∫Øc 1\% t∆∞∆°ng t·ª± nguy√™n t·∫Øc ``ƒëa d·∫°ng h√≥a r·ªßi ro'' trong ƒë·∫ßu t∆∞: kh√¥ng bao gi·ªù ƒë·∫∑t t·∫•t c·∫£ tr·ª©ng v√†o m·ªôt gi·ªè. Trong trading, ƒëi·ªÅu n√†y c√≥ nghƒ©a l√† kh√¥ng bao gi·ªù r·ªßi ro qu√° nhi·ªÅu trong m·ªôt l·ªánh duy nh·∫•t.

\subsection*{C. C√¥ng th·ª©c t√≠nh kh·ªëi l∆∞·ª£ng v·ªã th·∫ø (25')}

\textbf{B∆∞·ªõc 1: Gi·ªõi thi·ªáu c√¥ng th·ª©c (10')}
\begin{itemize}[leftmargin=0.5cm]
    \item \textbf{C√¥ng th·ª©c c∆° b·∫£n:}
    \[
    \text{Kh·ªëi l∆∞·ª£ng} = \frac{\text{V·ªën} \times \text{Risk\%}}{\text{Gi√° Entry} \times \text{SL\%}}
    \]
    \item \textbf{Gi·∫£i th√≠ch t·ª´ng th√†nh ph·∫ßn:}
    \begin{itemize}
        \item \textbf{V·ªën $\times$ Risk\%:} S·ªë ti·ªÅn b·∫°n s·∫µn s√†ng m·∫•t (v√≠ d·ª•: \$10,000 $\times$ 1\% = \$100)
        \item \textbf{Gi√° Entry $\times$ SL\%:} Kho·∫£ng c√°ch stop loss t√≠nh b·∫±ng ti·ªÅn (v√≠ d·ª•: \$43,250 $\times$ 2\% = \$865)
        \item \textbf{Kh·ªëi l∆∞·ª£ng:} S·ªë l∆∞·ª£ng coin/token b·∫°n s·∫Ω mua ƒë·ªÉ n·∫øu gi√° gi·∫£m SL\%, b·∫°n ch·ªâ m·∫•t ƒë√∫ng s·ªë ti·ªÅn r·ªßi ro ƒë√£ ƒë·ªãnh
    \end{itemize}
    \item \textbf{V√≠ d·ª• c·ª• th·ªÉ:}
    \begin{itemize}
        \item V·ªën: \$10,000
        \item Risk: 1\% = \$100
        \item Gi√° BTC: \$43,250
        \item Stop Loss: 2\% = \$43,250 $\times$ 0.02 = \$865
        \item Kh·ªëi l∆∞·ª£ng = \$\frac{100}{865} \approx 0.1156$ BTC
        \item Ki·ªÉm tra: N·∫øu gi√° gi·∫£m 2\% t·ª´ \$43,250 xu·ªëng \$42,393.5, b·∫°n m·∫•t: 0.1156 $\times$ \$865 = \$100 ‚úì
    \end{itemize}
\end{itemize}

\textbf{B∆∞·ªõc 2: ƒê·ªçc code trong risk\_manager.py (10')}
\begin{itemize}[leftmargin=0.5cm]
    \item HS m·ªü file \texttt{src/risk\_manager.py}, t√¨m h√†m \texttt{calculate\_position\_size()}
    \item GV h∆∞·ªõng d·∫´n ƒë·ªçc t·ª´ng d√≤ng:
    \begin{verbatim}
    risk_amount = self.account_balance * (self.risk_percent / 100)
    stop_loss_amount = entry_price * (self.stop_loss_percent / 100)
    quantity = risk_amount / stop_loss_amount
    \end{verbatim}
    \item So s√°nh v·ªõi c√¥ng th·ª©c tr√™n: code ƒëang l√†m ƒë√∫ng theo c√¥ng th·ª©c!
    \item \textbf{ƒêi·ªÉm ƒë·∫∑c bi·ªát:} Code c√≤n x·ª≠ l√Ω tr∆∞·ªùng h·ª£p c√≥ ATR:
    \begin{itemize}
        \item N·∫øu c√≥ ATR, d√πng \texttt{atr\_stop\_loss = current\_atr * 2} thay v√¨ SL\% c·ªë ƒë·ªãnh
        \item ƒêi·ªÅu n√†y linh ho·∫°t h∆°n v√¨ ATR ph·∫£n √°nh bi·∫øn ƒë·ªông th·ª±c t·∫ø c·ªßa th·ªã tr∆∞·ªùng
    \end{itemize}
\end{itemize}

\textbf{B∆∞·ªõc 3: Th·ª±c h√†nh t√≠nh to√°n v·ªõi s·ªë li·ªáu th·∫≠t (5')}
\begin{itemize}[leftmargin=0.5cm]
    \item Ch·∫°y bot, quan s√°t log khi bot t√≠nh v·ªã th·∫ø
    \item So s√°nh s·ªë li·ªáu trong log v·ªõi c√¥ng th·ª©c:
    \begin{itemize}
        \item Log hi·ªÉn th·ªã: ``üí∞ T√≠nh to√°n v·ªã th·∫ø: Kh·ªëi l∆∞·ª£ng: 0.1156, R·ªßi ro: \$100.00''
        \item HS ki·ªÉm tra l·∫°i b·∫±ng c√¥ng th·ª©c ƒë·ªÉ x√°c nh·∫≠n
    \end{itemize}
    \item \textbf{B√†i t·∫≠p:} Thay ƒë·ªïi \texttt{RISK\_PERCENTAGE} trong \texttt{config.py} t·ª´ 1.0 th√†nh 2.0, ch·∫°y l·∫°i bot v√† quan s√°t kh·ªëi l∆∞·ª£ng thay ƒë·ªïi nh∆∞ th·∫ø n√†o?
\end{itemize}

\subsection*{D. Stop Loss v√† Take Profit (20')}

\textbf{B∆∞·ªõc 1: Stop Loss d·ª±a tr√™n ATR (10')}
\begin{itemize}[leftmargin=0.5cm]
    \item \textbf{T·∫°i sao d√πng ATR?}
    \begin{itemize}
        \item ATR ƒëo bi·∫øn ƒë·ªông th·ª±c t·∫ø c·ªßa th·ªã tr∆∞·ªùng
        \item Khi ATR cao (th·ªã tr∆∞·ªùng bi·∫øn ƒë·ªông m·∫°nh), c·∫ßn ƒë·∫∑t SL xa h∆°n ƒë·ªÉ tr√°nh b·ªã ``stop out'' s·ªõm
        \item Khi ATR th·∫•p (th·ªã tr∆∞·ªùng ·ªïn ƒë·ªãnh), c√≥ th·ªÉ ƒë·∫∑t SL g·∫ßn h∆°n ƒë·ªÉ b·∫£o v·ªá v·ªën t·ªët h∆°n
    \end{itemize}
    \item \textbf{C√¥ng th·ª©c trong bot:}
    \begin{itemize}
        \item Stop Loss = Entry Price $\pm$ (2 $\times$ ATR) [D·∫•u + cho SELL, d·∫•u - cho BUY]
        \item Take Profit = Entry Price $\pm$ (3 $\times$ ATR)
        \item V√≠ d·ª•: Entry = \$43,250, ATR = \$250
        \begin{itemize}
            \item SL (BUY) = \$43,250 - (2 $\times$ \$250) = \$42,750
            \item TP (BUY) = \$43,250 + (3 $\times$ \$250) = \$44,000
        \end{itemize}
    \end{itemize}
    \item \textbf{So s√°nh v·ªõi SL\% c·ªë ƒë·ªãnh:}
    \begin{itemize}
        \item SL\% c·ªë ƒë·ªãnh: SL = \$43,250 $\times$ 0.98 = \$42,385 (c√°ch entry 2\%)
        \item SL d·ª±a ATR: SL = \$42,750 (c√°ch entry 1.16\%)
        \item ATR linh ho·∫°t h∆°n, ph√π h·ª£p v·ªõi ƒëi·ªÅu ki·ªán th·ªã tr∆∞·ªùng th·ª±c t·∫ø
    \end{itemize}
\end{itemize}

\textbf{B∆∞·ªõc 2: Take Profit v√† Risk/Reward Ratio (10')}
\begin{itemize}[leftmargin=0.5cm]
    \item \textbf{Risk/Reward Ratio (R/R):}
    \[
    R/R = \frac{\text{Kho·∫£ng c√°ch Take Profit}}{\text{Kho·∫£ng c√°ch Stop Loss}}
    \]
    \item \textbf{V√≠ d·ª•:}
    \begin{itemize}
        \item Entry: \$43,250
        \item SL: \$42,750 (risk = \$500)
        \item TP: \$44,000 (reward = \$750)
        \item R/R = \$\frac{750}{500} = 1.5
    \end{itemize}
    \item \textbf{√ù nghƒ©a R/R:}
    \begin{itemize}
        \item R/R = 1.5 nghƒ©a l√†: m·ªói \$1 r·ªßi ro, b·∫°n k·ª≥ v·ªçng ki·∫øm \$1.5 l·ª£i nhu·∫≠n
        \item R/R $\geq$ 1.5 ƒë∆∞·ª£c coi l√† t·ªët (l·ª£i nhu·∫≠n ti·ªÅm nƒÉng l·ªõn h∆°n r·ªßi ro)
        \item R/R < 1.0 nghƒ©a l√† r·ªßi ro l·ªõn h∆°n l·ª£i nhu·∫≠n $\Rightarrow$ kh√¥ng n√™n v√†o l·ªánh
    \end{itemize}
    \item \textbf{ƒê·ªçc code:} T√¨m h√†m \texttt{calculate\_risk\_reward\_ratio()} trong \texttt{risk\_manager.py}
\end{itemize}

\subsection*{E. Th·ª±c h√†nh t·ªïng h·ª£p (20')}

\textbf{B√†i t·∫≠p l·ªõn: T√≠nh to√°n ho√†n ch·ªânh m·ªôt l·ªánh (15')}
\begin{itemize}[leftmargin=0.5cm]
    \item \textbf{ƒê·ªÅ b√†i:}
    \begin{itemize}
        \item V·ªën: \$10,000
        \item Risk: 1\%
        \item Gi√° BTC hi·ªán t·∫°i: \$43,250
        \item ATR: \$250
        \item Signal: BUY
    \end{itemize}
    \item \textbf{Y√™u c·∫ßu:}
    \begin{enumerate}
        \item T√≠nh s·ªë ti·ªÅn r·ªßi ro t·ªëi ƒëa
        \item T√≠nh Stop Loss v√† Take Profit (d√πng ATR)
        \item T√≠nh kh·ªëi l∆∞·ª£ng v·ªã th·∫ø
        \item T√≠nh Risk/Reward Ratio
        \item K·∫øt lu·∫≠n: C√≥ n√™n v√†o l·ªánh kh√¥ng? (R/R $\geq$ 1.5?)
    \end{enumerate}
    \item \textbf{ƒê√°p √°n g·ª£i √Ω:}
    \begin{itemize}
        \item R·ªßi ro = \$10,000 $\times$ 1\% = \$100
        \item SL = \$43,250 - (2 $\times$ \$250) = \$42,750
        \item TP = \$43,250 + (3 $\times$ \$250) = \$44,000
        \item Kh·ªëi l∆∞·ª£ng = \$\frac{100}{500} = 0.2$ BTC
        \item R/R = \$\frac{750}{500} = 1.5 ‚úì (ƒê√°ng v√†o l·ªánh)
    \end{itemize}
\end{itemize}

\textbf{So s√°nh v·ªõi bot (5')}
\begin{itemize}[leftmargin=0.5cm]
    \item Ch·∫°y bot v·ªõi s·ªë li·ªáu t∆∞∆°ng t·ª±, quan s√°t log
    \item So s√°nh k·∫øt qu·∫£ t√≠nh to√°n c·ªßa bot v·ªõi k·∫øt qu·∫£ t√≠nh tay
    \item Th·∫£o lu·∫≠n: C√≥ kh√°c bi·ªát kh√¥ng? V√¨ sao?
\end{itemize}

\subsection*{F. T·ªïng k·∫øt v√† Q\&A (5')}
\begin{itemize}[leftmargin=0.5cm]
    \item GV t·ªïng h·ª£p:
    \begin{itemize}
        \item Quy t·∫Øc 1\% gi√∫p b·∫£o v·ªá v·ªën
        \item C√¥ng th·ª©c t√≠nh kh·ªëi l∆∞·ª£ng ƒë·∫£m b·∫£o r·ªßi ro kh√¥ng v∆∞·ª£t qu√° ng∆∞·ª°ng
        \item SL/TP d·ª±a tr√™n ATR linh ho·∫°t h∆°n SL\% c·ªë ƒë·ªãnh
        \item R/R $\geq$ 1.5 l√† ti√™u chu·∫©n cho l·ªánh t·ªët
    \end{itemize}
    \item Q\&A: HS ƒë·∫∑t c√¢u h·ªèi v·ªÅ ph·∫ßn ch∆∞a hi·ªÉu
\end{itemize}

\section*{4. B√†i t·∫≠p v·ªÅ nh√†}
\begin{itemize}[leftmargin=1.2cm]
    \item T√≠nh to√°n ho√†n ch·ªânh 2 l·ªánh m·∫´u kh√°c (v·ªõi s·ªë li·ªáu kh√°c nhau) v√† ki·ªÉm tra R/R.
    \item ƒê·ªçc k·ªπ h√†m \texttt{calculate\_position\_size()} trong \texttt{risk\_manager.py}, vi·∫øt comment gi·∫£i th√≠ch t·ª´ng b∆∞·ªõc t√≠nh to√°n.
    \item (T√πy ch·ªçn) Th·ª≠ thay ƒë·ªïi \texttt{STOP\_LOSS\_PERCENT} v√† \texttt{TAKE\_PROFIT\_PERCENT} trong \texttt{config.py}, quan s√°t s·ª± thay ƒë·ªïi c·ªßa R/R ratio.
\end{itemize}

\section*{5. Ghi ch√∫ cho gi√°o vi√™n}
\begin{itemize}[leftmargin=1.2cm]
    \item Nh·∫•n m·∫°nh r·∫±ng quy t·∫Øc 1\% l√† ``kim ch·ªâ nam'' trong qu·∫£n l√Ω r·ªßi ro, kh√¥ng ph·∫£i con s·ªë tuy·ªát ƒë·ªëi.
    \item Khuy·∫øn kh√≠ch HS t√≠nh tay tr∆∞·ªõc khi xem k·∫øt qu·∫£ c·ªßa bot ƒë·ªÉ hi·ªÉu s√¢u h∆°n.
    \item N·∫øu HS g·∫∑p kh√≥ khƒÉn v·ªõi c√¥ng th·ª©c, c√≥ th·ªÉ d√πng v√≠ d·ª• tr·ª±c quan: ``N·∫øu b·∫°n c√≥ 100 vi√™n k·∫πo v√† ch·ªâ mu·ªën m·∫•t t·ªëi ƒëa 1 vi√™n m·ªói l·∫ßn ch∆°i...''
    \item Nh·∫Øc nh·ªü: Lu√¥n ki·ªÉm tra R/R tr∆∞·ªõc khi v√†o l·ªánh, ƒë√¢y l√† th√≥i quen t·ªët c·ªßa trader chuy√™n nghi·ªáp.
\end{itemize}

\vspace{0.5cm}
\begin{center}
\textbf{K·∫øt th√∫c bu·ªïi 4:}\\
\textit{H·ªçc sinh hi·ªÉu v√† c√≥ th·ªÉ t√≠nh to√°n kh·ªëi l∆∞·ª£ng v·ªã th·∫ø, ƒë·∫∑t SL/TP d·ª±a tr√™n ATR, v√† ƒë√°nh gi√° l·ªánh qua R/R ratio.}
\end{center}

\end{document}
